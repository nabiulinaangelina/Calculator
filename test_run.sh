#!/bin/bash

echo "=== Тестирование калькулятора на Linux ==="
echo

# 1. Сборка проекта
echo "1. Сборка проекта..." 
mkdir -p build
cd build
cmake .. 
make

if [ $? -ne 0 ]; then
    echo "Ошибка сборки!"
    exit 1
fi

echo "/ Сборка успешна"
echo

# 2. Запуск тестов
echo "2. Запуск модульных тестов..." 
./bin/tests_calculator

if [ $? -ne 0 ]; then
    echo "Тесты не прошли!"
    exit 1
fi

echo "/ Тесты прошли успешно"
echo

# 3. Запуск в демо-режиме
echo "3. Запуск в демо-режиме..." 
echo "--- Демо-режим ---"
./bin/app_calculator --demo
echo

# 4. Запуск в тестовом режиме
echo "4. Запуск в тестовом режиме..."
echo "--- Тестовый режим ---"
./bin/app_calculator --test
echo

# 5. Запуск с выражением (заглушка)
echo "5. Запуск с вычислением выражения..." 
echo "--- Режим вычисления ---"
./bin/app_calculator --calculate="5 + 3 * 2"
echo

# 6. Запуск с меню (интерактивный режим)
echo "6. Запуск с меню (нажмите Ctrl+C для выхода)..." 
echo "--- Интерактивный режим ---"
echo "Примечание: выберите пункт 1 для демо, затем 0 для выхода"
./bin/app_calculator

echo
echo "=== Все тесты завершены ==="